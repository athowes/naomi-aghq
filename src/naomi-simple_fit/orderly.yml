script: script.R

sources:
  - functions.R

artefacts:
  - data:
      description: Inference output
      filenames:
        - out.rds

parameters:
  #' Run inference with TMB? Yes or no
  tmb:
    default: FALSE
  #' Run inference with aghq? Yes or no
  aghq:
    default: FALSE
  #' Default number of grid points per hyperparameter dimension for aghq
  k:
    default: 2
  #' Type of grid to use for aghq, either product or sparse
  ndConstruction:
    default: "product"
  #' Run inference with tmbstan? Yes or no
  tmbstan:
    default: FALSE
  #' Default number of iterations for tmbstan, with four chains
  niter:
    default: 1000
  #' Thinning parameter for tmbstan
  nthin:
    default: 1
  #' Run inference with new method under development? Yes or no
  adam:
    default: FALSE
  #' Number of samples to draw from the fitted model (not applicable to tmbstan)
  nsample:
    default: 1000
  #' The level at which the model is run. This can be used to make computation
  #' easier or harder. The default is 4, but by making it e.g. 3 then everything
  #' should run a lot faster because there will be fewer areas
  area_level:
    default: 4

resources:
  - naomi_simple.cpp
  - naomi_simple_x_index.cpp
  - dev

packages:
  - dplyr
  - forcats
  - ggplot2
  - readr
  - tidyr
  - purrr
  - stringr
  - Matrix
  - TMB
  - tmbstan
  - rstan
  - aghq
  - sf
  - naomi

depends:
  naomi-simple_compare:
    id: latest
    use:
      depends/beta_rho.rds: beta_rho.rds
  naomi-simple_fit:
    id: latest(parameter:aghq == TRUE && parameter:k == 1)
    use:
      depends/aghq.rds: out.rds
  naomi-simple_fit:
    id: latest(parameter:adam == TRUE)
    use:
      depends/adam.rds: out.rds
